---
import Layout from '../../layouts/Layout.astro';
import TopBar from '../../components/TopBar.astro';
import Breadcrumb from '../../components/Breadcrumb.astro';
import { getCollection } from 'astro:content';
import { getCoverImageUrl } from '../../utils/coverImage.ts';
import { getTagColorCSS } from '../../utils/tagColors.ts';
import '../../styles/page-blog.css';

const title = "Blog";
const description = "Notes and long-form posts on AI, reasoning, and what I'm learning.";
const notes = await getCollection('notes');
---

<Layout title={`${title} - Shristi Gautam`} description={description} ogImage="/assets/bio-image.jpg">
  <TopBar />
  <Breadcrumb items={[
    { label: 'Home', href: '/' },
    { label: 'Blog' }
  ]} />
  <div class="page-container page-blog-container">
    <header class="page-blog-header app-struct">
      <h1 class="page-title page-blog-title">{title}</h1>
      <p class="page-blog-intro">
        {description}
      </p>
    </header>
    <div class="page-blog-list">
      {notes.map((entry) => (
        <a href={`/notes/${entry.slug}`} class="page-blog-card app-struct">
          <div class="page-blog-card-image-wrap">
            <img src={getCoverImageUrl('notes', entry.slug)} alt="" class="page-blog-card-image" loading="lazy" />
          </div>
          <div class="page-blog-card-body">
            <h2 class="page-blog-card-title">{entry.data.title}</h2>
            <p class="page-blog-card-description">{entry.data.description}</p>
            {entry.data.publishedDate && (
              <time class="page-blog-card-date" datetime={entry.data.publishedDate}>{entry.data.publishedDate}</time>
            )}
            {entry.data.tags?.length > 0 && (
              <span class="page-blog-card-tags">
                {entry.data.tags.map((tag: string) => {
                  const colorCSS = getTagColorCSS(tag);
                  return (
                    <span class="page-blog-card-tag shared-tag-link" style={colorCSS}>{tag}</span>
                  );
                })}
              </span>
            )}
            <span class="page-blog-card-link">Read post â†’</span>
          </div>
        </a>
      ))}
    </div>
  </div>
</Layout>
